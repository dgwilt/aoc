from numpy import dot

data = """           /----------------------------------------------------------------\\                                     /-----------------\\                 
           |                                                                |                              /------+-----------------+-----------\\     
    /------+---------------\\                /-------------------------------+------------------------------+------+---------------\\ |           |     
    |      |               |                v                 /-------------+-------------\\                |      |               | |           |     
    |      |               |                |   /-------------+-------------+-------------+----------------+------+---------------+-+---------\\ |     
    |      |               |           /----+---+---\\         |             |             |     /----------+------+-----------\\   | |         | |     
    |      |               |           |    |   |   |         |            /+-------------+-----+----------+-----\\|           |   | |         | |     
   /+------+---------------+-----------+----+---+---+---------+------------++-------------+-----+----------+-\\   ||           |   | |         | |     
   ||      |               |       /---+----+---+---+---------+------------++-------------+-----+-------\\  | |   ||           |   | |         | |     
   ||      |               | /-----+---+----+-\\ |   |         |         /--++-------------+-----+-------+--+-+---++----\\      |   | |         | |     
   ||      |               | |     |   |    | | |   |        /+---------+--++-------------+-----+-------+--+-+---++----+------+---+-+----\\    | |     
/--++------+---------------+-+-----+---+----+-+-+---+--------++---------+--++---\\         |  /--+-------+--+-+---++----+------+\\  | |    |    | |     
|  ||      |               | |     |   |    | | |   |        ||         |  ||   |         |  |  |       |  | |   ||    |      ||  | |    |    | |     
|  ||      |               | |     |   |  /-+-+-+---+----\\  /++---------+--++---+-\\      /+--+--+-------+--+-+---++----+------++--+-+----+----+-+-\\   
|  ||      | /-------------+-+-----+---+--+-+-+-+---+----+--+++---------+--++---+-+------++--+--+-\\     |  ^ |   ||    |     /++--+-+----+\\   | | |   
|  ||      | |          /--+-+-----+---+--+-+-+-+---+----+--+++---------+--++---+-+------++--+-\\| |     |  | |   ||/---+-----+++--+-+----++--\\| | |   
|  ||      | |          |  | | /---+---+--+-+-+\\|   |    |  |||         |/-++---+-+------++--+-++-+-----+--+-+-\\ |||   |     |||  | |    ||  || | |   
|  ||      | |          |  | | |/--+---+--+-+-+++---+----+--+++---------++-++---+-+------++--+-++\\|     |  | | | |||   |     |||  | |    ||  || | |   
|  |\\------+-+----------+--/ | ||  |   |  | | |||   |    |  |||         || ||   | |      ||  | ||||     |  | | | |||   |     |||  | |    ||  || | |   
|  |       | |          |    | ||  |   | /+-+-+++---+----+--+++---------++-++---+-+------++--+-++++-----+--+-+-+-+++---+-----+++--+-+--\\ ||  || | |   
|  |       | |          |    \\-++--+---+-++-+-/||   |    |  |||         || ||   | |      ||  | ||||     |  | | | |||   |     |||  | |  | ||  || | |   
|  |       | |          |      ||  |   | || v  ||/--+----+--+++---------++-++---+-+------++--+-++++-----+--+-+-+-+++---+--\\  |||  | |  | ||  || | |   
|  |       | |          |      ||  |   \\-++-+--+++--/    |  |||         || ||   | |      ||  | ||||     |  | | | |||   |  |  |||  | |  | ||  || | |   
|  |   /---+-+----------+-----\\||  |     || |  |||       |  |||         || ||   | |      ||  | ||||     |  | | | |\\+---+--+--+++--+-/  | ||  || | |   
|  |   |   | |          |     |||  |     || |  |||   /---+--+++---------++-++---+\\|     /++--+-++++----\\|  | | | | |   |  |  |||  |    | ||  || | |   
|  |   |  /+-+----------+---\\ |||  |     || |  |||   |   |  |||    /----++-++---+++---\\ |\\+--+-++++----++--+-+-+-+-+---+--+--+++--+----+-++--++-+-/   
|  |   |  || |          |/--+-+++--+-----++-+--+++---+\\  |  \\++----+----++-++---++/   | | |  | ||||    ||  | | | | |   |  |  |||  |    | ||  || |     
|  |   |  || |      /---++--+-+++--+-----++-+--+++---++--+-\\ || /--+----++-++---++----+-+-+--+-++++---\\||  | | | | |   |  |  |||  |    | ||  || |     
|  |   |  || |     /+---++--+-+++--+-----++-+--+++---++--+-+-++-+--+----++-++---++----+-+-+--+-++++---+++--+-+-+\\| |   |  |  |||  |    | ||  || |     
|  |   |  || |     ||   ||  | |||  |     || |  |||   ||  | | || |  |/---++-++---++--\\ | | |  | ||||   |||  | | ||| |   |  |  |||  |    | ||  || |     
|  |   |  || |  /--++---++--+-+++--+-\\   || |  |||  /++--+-+-++-+--++---++-++---++-\\| | | |  | ||||   |||  | | ||| |   |  |  |||  |    | ||  || |     
|  |   |  || |  |  ||   || /+-+++--+-+---++-+--+++--+++--+-+-++-+--++---++-++---++-++-+-+-+--+-++++---+++--+-+-+++-+-\\ |  |  |||  |    | ||  || |     
|  |   |  || |  |  ||   || || |||  | |   || |  |||  |||  | | || |  ||   || ||/--++-++-+-+-+--+-++++---+++--+-+-+++-+-+-+--+--+++--+----+-++--++\\|     
|  |   |  || |  |  ||   || || |||  | | /-++-+--+++--+++--+-+-++\\|  ||   || |||  || || | | |  | ||||   |||  | | ||| | | |  |  |||  |    | ||  ||||     
|  |   |/-++-+--+--++---++-++-+++--+-+\\| || |  |||  ||| /+-+-++++-<++---++-+++-\\|| || | | |  | ||||   |||  \\-+-+++-+-+-+--+--+++--+----+-++--+++/     
|  |   || || |  |  ||   || || |||  | ||| || |  |||  ||| || | ||||  ||   || ||| ||| || | | |  | ||||   |||    | ||| | | |  |  |||  |    | ||  |||      
|/-+---++-++-+--+--++--\\|| || |||  | ||| || |/-+++--+++-++-+-++++--++---++-+++-+++-++-+-+-+--+-++++---+++----+-+++-+\\| |/-+--+++--+----+-++--+++----\\ 
|| |   || || |  |  ||  ||| || |||  | ||| || || |||  ||| || | ||||  ||   || ||| ||| || | |/+--+-++++---+++----+-+++-+++-++\\|  |||  |    | ||  |||    | 
|| |   || || |  |  ||  ||| || |||  | ||v || || |||  ||| || | ||||  ||   || ||| ||| || | |||/-+-++++---+++--\\ | ||| ||| ||||  |||  |    | ||  |||    | 
|| |   || || |  |  ||  ||| ||/+++--+-+++-++-++-+++--+++-++-+-++++--++---++-+++-+++-++\\| |||| | ||||   |||  | | |v| \\++-++++--+++--+----+-++--/||    | 
|| |   || || |  |  ||  ||| ||||||  | |||/++-++-+++--+++-++-+-++++--++---++-+++-+++-++++-++++-+-++++---+++--+-+\\|||  || ||||  |||  |    | ||   ||    | 
|| |   || || |  |  ||  ||| ||||||  | |||||| || |||  ||| || | ||||  ||   || ||| ||| |||| |||| | ||||   |||  | |||||  || ||||  |||  |    | ||   ||    | 
|| |   || || |  |  ||  ||| ||||||  | |||||| || ||| /+++-++-+-++++--++---++-+++-+++-++++-++++-+-++++---+++--+-+++++--++-++++--+++--+----+-++---++\\   | 
|| |   || || |  |  ||  ||| |||||| /+-++++++-++-+++-++++-++-+-++++--++---++-+++-+++-++++-++++-+-++++---+++--+-+++++--++-++++-\\|||  |    | ||   |||   | 
|| |   || || |  |  ||  ||| |||||| || |||||| || ||| |||| || | |||\\--++---++-+++-+++-++++-++++-+-++++---/||  |/+++++--++-++++-++++\\ |    | ||   |||   | 
|| |   || || |  |  ||  ||| |||||| || |||||| || ||| ||||/++-+-+++---++---++-+++-+++-++++-++++-+-++++\\   || /+++++++--++\\|||| ||||| |    | ||   |||   | 
|| |   || || |  |  ||  ||| |||||| || |||||| || ||| ||||||| | |||   ||   || ||| ||| |||| |||| | |||||   || ||||||||  ||||||| ||||| |    | ||   |||   | 
|| \\---++-++-+--+--++--+++-++++++-++-++++++-++-+++-+++++++-+-+++---++---++-+++-+++-++++-++++-+-+++++---++-+++/||||  ||||||| ||||| |    | ||   |||   | 
||     || || |  |  \\+--+++-++++++-++-++++++-++-+++-+++++++-+-+++---++---++-+++-+++-++++-++++-+-+++++---++-+++-++/|  ||||||| ||||| |    | ||   |||   | 
||     || || |  |   |  ||| |||||| || |||||| || ||| ||||||| | |||   ||   || ||| ||| |||| |||| | |||||   || ||| || |  ||||||| ||||| |    | ||   |||   | 
|| /---++-++-+--+---+--+++-++++++-++-++++++-++-+++-+++++++-+-+++---++---++-+++-+++\\|||| |||| | |||||   || ||| || |  ||||||| ||||| |    | ||   |||   | 
|| |   || || |  |   | /+++-++++++-++-++++++-++-+++-+++++++-+-+++---++---++-+++-++++++++-++++-+-+++++\\  || ||| || |  ||||||| ||||| |    | ||   |||   | 
|| |   || || | /+---+-++++-++++++-++-++++++-++-+++-+++++++-+-+++---++\\  || ||| |||||||| |||| | ||||||  || ||| || |  ||||||| ||||| |    | ||   |||   | 
|| |   || || | ||   | |||| |||||| || |||||| || ||| ||\\++++-+-+++---+++--++-+++-++/||||| |||| | ||||||  || ||| || |  ||||||| ||||| |    | ||   |||   | 
|| |   || || | ||   | |||| |||||| || |||||| || ||| || |||| | |||   |||  || ||| || ||||| |||| | ||||||  || ||| || |  ||||||| ||||| |    | ||   |||   | 
|| |   || || | ||   | |||| |||||| || |||||| || ||| |\\-++++-+-+++---+++--++-+++-++-+/||| |||| | ||||||  || ||| || |  ||||||| ||||| |    | ||   |||   | 
|| |   || || | ||   | |||| |||||| || ||||||/++-+++-+--++++-+-+++---+++--++-+++-++-+-+++-++++-+-++++++--++-+++-++-+--+++++++-+++++-+--\\ | ||   |||   | 
|| |   || || | ||   | |||| |||||| || ||||||||| ||| |  |||| | |||   |||  || \\++-++-+-+++-++++-+-++++++--++-+++-++-/  ||||||| ||||| |  | | ||   |||   | 
|| |   || || | ||   | |||| |||||| || ||||||||| |\\+-+--++++-+-+++---+++--++--++-++-+-+++-++++-+-++++++--++-+++-++----+++++++-+++++-+--+-+-++---/||   | 
|| |   || || | ||   | ||||/++++++-++-+++++++++-+-+\\|  |||| | |||   |||  ||  || || | ||| \\+++-+-++++++--/| |||/++<---+++++++-+++++-+--+-+-++----++---+\\
|| |   || || | ||   | ||||||||||| || ||||||||| | |||  |||| | \\++---+++--++--++-++-+-+++--+++-+-++++++---+-++++++----+++++++-+++++-+--+-+-/|    ||   ||
|| |   || |^ | ||   | ||||||||||| || |||||||||/+-+++--++++-+--++---+++\\ ||  || || | |||  ||| | ||||||   | ||||||    ||||||| ||||| |  | |  |    ||   ||
|| |   || || | ||   | ||||||||||| || ||||||||||| |||  |||| | /++---++++-++--++-++-+-+++--+++-+-++++++---+-++++++--\\ ||||||| ||||| |  | |  |    ||   ||
|| |   || || | ||   | ||||||||||| || ||||||||||| |||  |||| | |||   |||| ||  || || | |||  ||| | ||||||   | ||||||  | ||||||| ||||| |  | |  |    ||   ||
|| |/--++-++-+-++---+-+++++++++++-++-+++++++++++-+++--++++-+\\|||   |||| ||  || || | |||  ||| | ||||||   | ||||||  | ||||||| ||||| |  | |  |    ||   ||
|| ||  || || | ||   | ||||||||||| || ||||||||\\++-+++--++++-+++++---++++-++--++-++-+-+++--+++-+-++++++---+-++++++--+-/|||||| ||||| |  | |  |    ||   ||
|| ||  || || | ||   | |||\\+++++++-++-++++++++-++-+++--/||| |||||/--++++-++--++-++-+-+++--+++-+-++++++---+-++++++\\ |  |||||| ||||| |  | |  |    ||   ||
|| ||  ||/++-+-++---+-+++-+++++++-++-++++++++-++-+++---+++-++++++--++++-++--++-++-+-+++--+++-+-++++++---+-+++++++\\|  |||||| ||||| |  | |  |    ||   ||
|| ||  ||||| | ||   | ||| ||||||| || |||||\\++-++-+++---++/ ||||||  |^|| || /++-++-+-+++--+++-+-++++++---+-+++++++++--++++++-+++++-+--+-+--+----++-\\ ||
||/++--+++++-+-++---+\\||| ||||||| || ||||| || || |||   ||  ||||||  |||| |\\-+++-++-+-+++--+++-+-++++++---+-+++++/|||  |||||| ||||| |  | |  |    || | ||
|||||  ||||| | ||   ||||| ||||||| || ||||| || || |||   ||  ||||||  |||| |  ||| || | |||  ||| | ||||||   | ||||| |||  |||||| ||||| |  | |  |    || | ||
|||||  ||||| | ||   ||||| ||||||| |\\-+++++-++-++-+++---++--++++++--++++-+--+++-++-+-+++--+++-+-++++++---//+++++-+++--++++++-+++++-+--+-+--+\\   || | ||
|||||  ||||| | ||   ||||| ||||||| |  ||\\++-++-++-+++---++--++++/|  ||||/+--+++-++-+-+++--+++-+-++++++----++++++-+++--++++++-+++++-+--+-+\\ ||   || | ||
|||||  ||||| | ||   ||||| ||||||| |  || || || || |||   ||  |||| |  ||||||  ||| || | |||  |||/+-++++++----++++++-+++--++++++-+++++-+--+\\|| ||   || | ||
|||||  ||||| | ||   ||||| ||||||| |  || || || || |||   || /++++-+--++++++--+++-++-+-+++--+++++-++++++----++++++-+++--++++++-+++++-+--++++-++---++-+\\||
|||||  ||||| | ||   ||||| ||||||| |  || || || || |||   || ||||| |  ||||||  ||| || | |||  ||||\\-++++++----++++++-+++--++++++-+++/| |  |||| ||   || ||||
|||||  ||||| | \\+---+++++-+++++++-+--++-++-++-++-+++---++-+++++-+--++/|||  ||| || | |||  ||||  ||||||    |||||| |||  |||||| ||| | |  |||| ||   || ||||
|||^|  ||||| |  |   ||||| ||||||| |  || || || || |||   || ||||| |  || |||  ||| || | |||  |||| /++++++----++++++-+++--++++++-+++-+-+--++++-++---++\\||||
|||||  ||||| |  |   ||||| ||||||| |  || || || || |||   || |||\\+-+--++-+++--+++-++-+-+++--++++-+++++++----++++++-++/  |||||| ||| | |  |||| ||   |||||||
|||||  ||||| |  |   ||||| |||||\\+-+--++-++-++-+/ |||   || ||| \\-+--++-+++--+++-++-+-+++--+/|| |||||||  /-++++++-++---++++++-+++-+-+--++++\\||   |||||||
|||||  ||||| |  \\---+++++-+++++-+-+--/| || || |  |||   || |||   |  || |||  ||| || | |||  | || ||\\++++--+-++++++-++---++++++-++/ | |  |||||||   |||||||
|||||  ||||| |      |v||| ||||| | |   | || || |  |||   || |||   |  \\+-+++--+++-++-+-++/  | || || ||||/-+-++++++-++---++++++-++--+-+-\\|||||||   |||||||
|||||  ||||| |    /-+++++-+++++-+-+---+-++-++-+--+++---++-+++---+---+\\|||  ||| || | ||   | || || ||||| | |||\\++-++---++++++-++--/ | ||||||||   |||||||
|^|||  ||||| |    | ||||| ||||| | |   | || || |  |||   || |||   |   ||||\\--+++-++-+-++---+-++-++-+++++-+-+++-++-++---++/||| ||    | ||||||||   |||||||
|||||  ||||| |    | ||||| ||||| |/+---+-++-++-+--+++---++-+++---+---++++---+++-++-+-++---+-++-++-+++++-+-+++-++-++---++-+++-++----+\\||||||||   |||||||
|||||  ||||| |    | ||||| ||||| |||   | || || |  |||   || |||   |   ||||   ||| || | ||   | || || ||||| |/+++-++-++\\  || ||| ||    ||||||||||   |||||||
|||||  ||||| |    | ||||| ||||| |||   | || || |  |||   |\\-+++---+---++++---+++-/| | ||  /+-++-++-+++++-+++++-++-+++--++-+++\\||    ||||||||||   |||||||
|||||  ||||| | /--+-+++++-+++++-+++---+-++-++-+--+++---+--+++---+--\\||||   |||  | | ||  || || || ||||| ||||| || |||  || ||||||    ||||||||||   |||||||
|||||  ||||| | |  | ||||| ||||| ||| /-+-++-++-+--+++---+--+++---+--+++++---+++--+-+-++--++-++-++-+++++-+++++-++\\|||  || ||||||    ||||||||||   |||||||
|||||  ||||| | |  | ||||| ||||| ||| | | || || |  |||   |  |||   |  |||||   \\++--+-+-++--++-++-++-+++++-+++++-++++++--++-++++++----++++++++++---+++/|||
|||||  ||||| | |  | ||||| ||||| ||| | | || || |  |||   |  |||   |  |||||    ||  | | ||  || || || ||||| ||||| ||||||  || ||||||    ||||||||||   ||| |||
|||||  ||||| | |  | ||||| ||||| ||| | | || || |  \\++---+--+++---+--+++++----++--+-+-++--++-++-++-+++++-+++++-++++++--++-++/||\\----++++++++/|   ||| |||
|||||  ||||| | |  | ||||| ||||| ||| | | || || |   ||   |  |||   |/-+++++----++--+-+-++--++-++-++-+++++-+++++-++++++--++-++-++----\\|||||||| |   ||| |||
|||||  ||||| \\-+--+-+++++-+++++-+++-+-+-++-++-+---++---+--+++---++-+++++----++--+-+-++--++-++-++-+/||| ||||| ||||||/-++-++-++----+++++++++-+-\\ ||| |||
|||||  |||||   |  | ||||| ||||| ||| | | || || |  /++---+--+++\\  || |||||    ||  | | ||  || || || | ||| ||||| \\++++++-++-++-++----+++++++++-+-+-+++-++/
|||||  \\++++---+--+-+++++-++++/ ||| | | || || |/-+++---+-\\||||  || |||||    ||  | | ||  || || || | ||| ||\\++--++++++-++-++-++----+++++++++-/ | ||| || 
|||||   ||||   |  | ||||| ||||  ||| |/+-++-++-++-+++<--+-+++++--++-+++++----++--+-+-++--++\\|| || | ||| || ||  |||||| || || ||    |||||||||   | ||| || 
|||||   ||||   |  | ||||| ||||  ||| ||| || || || |||/<-+-+++++--++\\|||||    ||  | | ||  ||||| || | ||| ||/++--++++++-++\\|| ||    |||||||||   | ||| || 
|||||   ||||   |  | ||||| ||||  ||| ||| || || || ||||  | |||||  ||||||||    ||  | | ||  ||||\\-++-+-+++-+++++--++++++-+++++-++----+++++/|||   | ||| || 
|||||   ||||  /+--+-+++++-++++--+++-+++-++-++-++-++++--+-+++++--++++++++----++--+-+-++--++++--++-+-+++\\|||||  |||||| ||||| ||    ||||| |||   | ||| || 
|||||   ||||  ||  | ||||| ||||  ||| ||| || |\\-++-++++--+-+++++--++++++++----++--+-+-++--++++--++-+-+++++++++--++++++-+++++-++----+/||| |||   | ||| || 
\\++++---++++--++--+-+++++-++++--+++-+++-++-+--++-++++--+-+++++--++++++++----++--/ | ||  ||||  || | |||||||||  |||||| ||||| ||    | ||| |||   | ||| || 
 \\+++---++++--++--+-+++/| ||||  ||| ||| |\\-+--++-++++--+-+++++--++++++++----++----+-++--++++--++-+-+++++++++--++++++-+++++-++----+-+++-/||   | ||| || 
  |||   ||||  ||  | ||| | |||\\--+++-+++-+--+--++-++++--+-+++++--++++++++----++----+-+/  ||||  || | |||||||||  |||||| ||||| ||    | |||  ||   | ||| || 
  |||   \\+++--++--+-+++-+-+++---+++-++/ |  |  || ||||/-+-+++++--++++++++----++----+-+---++++--++-+-+++++++++--++++++-+++++-++\\   | |||  ||   | ||| || 
  |||    |||  ||  | ||| | |||   ||| ||  |  |  \\+-+++++-+-+++++--++++++/|    ||    | |   ||||  || | |||||||||  |||||| ||||| |||   | |||  ||   | ||| || 
  |||    |||  ||  | ||| | |||   ||| ||  |  |   | ||||| | |||||  |||||| |    ||    | |   ||||  || | |||||||||  |||||| ||||| |||   | |||  ||   | ||| || 
  |||    ||\\--++--+-+++-+-+++---+++-++--+--+---+-+++++-+-+++++--++++++-+----/|    | |   ||||  ||/+-+++++++++--++++++-+++++-+++---+-+++-\\||   | ||| || 
  |||    ||   ||/-+-+++-+-+++---+++-++--+--+---+-+++++-+-+++++--++++++-+-----+----+-+---++++-\\|||| |||||||||  |||||| ||||| |||   | ||| |||   | ||| || 
  |||    ||   ||| | ||| \\-+++---+++-++--+--+---+-+++++-+-+++++--++++++-+-----+----+-+---++++-++/|| |||||||||  |||||| ||||| |||   | ||| |||   | ||| || 
  |||    ||   ||| | |||   |||   ||| ||  \\--+---+-+++++-+-+++++--++++++-+-----+----+-+---++++-++-++-+++++++++--/||||| ||||| |||   | ||| |||   | ||| || 
  |||    ||   ||| | |||   |||   ||| ||     |   | ||||| | |||||  |\\++++-+--->-+----+-+---++++-++-++-+++++++++---+++++-+++++-+++---/ ||| |||   | ||| || 
  |||    ||   ||| | |||   |||   ||| |\\-----+---+-+++++-+-+++++--+-++++-+-----+----+-+---++/| || || |||||||||/--+++++-+++++-+++-----+++-+++---+-+++\\|| 
  |||    ||   ||| | |||   |||   \\++-+------+---+-+++++-+-+++++--+-++++-+-----+----+-+---++-+-++-+/ ||||||||||  ||||| ||||| |||     ||| |||   | |||||| 
  |||    ||   ||| | |||   \\++----++-+------+---+-+/||| | |||||  | |||| \\-----+----+-+---++-+-++-+--++++++++++--+++++-+++++-+++-----+++-+/|   | |||||| 
  |||    \\+---+++-+-+++----++----++-+------+---+-+-+++-+-+++++--+-++++-------+----+-+---++-+-++-+--++++++++++--++/|| ||||| |||     ||| | |   | |||||| 
  |||     |   ||| | |||    ||    || |      |   | | ||| | |||||  | ||||       |    | |   || | || \\--++++++++++--++-++-+++++-+++-----+++-/ |   | |||||| 
  |||     |   ||\\-+-+++----++----++-+------+---+-+-+++-+-+++++--+-++++-------+----+-+---++-+-/|    ||||\\+++++--++-++-+++++-+++-----+++---/   | |||||| 
  |||     |   ||  | |||    ||    |\\-+------+---+-+-+++-+-+++++--+-++++-------+----+-+---++-+--+----++++-+++++--++-++-+++++-+/|     |||       | |||||| 
  |||   /-+---++--+-+++----++----+--+------+---+-+-+++-+-+++++--+-++++--\\    |    | | /-++-+--+----++++-+++++--++-++-+++++-+-+-----+++-------+-++++++\\
  |||   | |   ||  | |||    ||    |  |      |   | | \\++-+-+++++--+-++++--+----+----+-+-+-++-+--+----++++-+++++--++-++-+++++-+-+-----+++-------+-+/|||||
  |||   | |   ||  | ||\\----++----+--+------+---+-+--++-+-+++++--+-++++--+----+----+-+-+-++-+--+----+/|| |||||  || || |||\\+-+-+-----+++-------+-+-+++/|
  |||   | |   ||  | ||     ||    |  |      |   | |  || | |||||  | ||||  |    |    | | | |\\-+--+----+-++-+++++--++-++-+++-/ | |     |||       | | ||| |
  |||   | |   |\\--+-++-----++----+--+------+---+-+--++-+-+++++--+-+/||  |    |    | | | |  |  |    | || |||||  || || |||   | |     |||       | | ||| |
  |||   | |   |   | ||     ||    |  \\------+---+-+--++-+-+++++--+-+-++--+----+----+-+-+-+--+--+----+-++-+++++--/| || |||   | |     |||       | | ||| |
  |||   | |   |   | ||     ||    |         |   | |  || | |||||  | | ||  |    |    | | | |  |  |    | || ||\\++---+-++-+/|   | |     |||       | | ||| |
  |||   | \\---+---+-++-----+/    |    /----+---+-+--++-+-+++++--+-+-++--+----+----+-+-+-+--+--+----+-++-++-++---+-++-+-+---+-+\\    |||       | | ||| |
  |||   |     |   | ||     |/----+----+----+---+-+--++\\| |||||  | | \\+--+----+----+-/ | |  |  |    | || \\+-++---+-/| | |   | ||    |||       | | ||| |
  |||   |     |   | ||     |^    |    |    |   | |  |||| |||||  | |  |  |    |    |   | |  |  |    | ||  \\-++---+--+-+-/   | ||    |||       | | ||| |
  |||   |     |   | ||     ||    \\----+----+---+-+--++++-+++++--+-+--+--+----+----+---+-+--+--+----+-++----++---+--+-+-----+-++----/||       | | ||| |
  |||   |     |   | \\+-----++---------+----+---+-+--++++-++/||  | |  |  |    |    |   | |  |  |    | ||    ||   |  \\-+-----+-++-----++-------/ | ||| |
  |||   |     |   |  |     ||         |    |   | |  |||| || ||  | |  |  |    |    |   | |  |  |    | ||    ||   |    |     | ||     ||         | ||| |
  |||   |     |   |  |     \\+---------+----+---+-+--++++-++-++--+-+--+--+----+----+---+-+--+--+----+-++----++---+----/     | ||     ||         | ||| |
  |||   |     |   |  |      |         |    |   | |  |||\\-++-++--+-+--+--+----+----+---+-+--+--+----/ ||    ||   |          | ||     ||         | ||| |
  |||   |     |   |  |      |         |    |   | \\--+++--++-+/  | |  |  |    |    |   | |  |  |      ||    ||   |          | ||     ||         | ||| |
  |||   |     |   |  |      |         |    |   \\----+++--/\\-+---+-+--+--+----+----+---+-+--+--+------++----++---+----------+-++-----++---------+-++/ |
  |||   |     |   |  |      |    /----+----+--------+++-----+-\\ | |  |  |    |    |   | |  |  |      \\+----++---+----------+-++-----/|         | ||  |
  |||   |     |   |  |      \\----+----+----+--------++/     | | | |  |  |    |    |   | |  |  |       |    ||   |          | ||      |         | ||  |
  |||   |     |   \\--+-----------+----+----+--------++------+-+-+-+--/  |    \\----+---+-+--+--+-------+----++---+----------+-++------+---------/ ||  |
  |||   |     |      |           |    |    |        |\\------+-+-+-+-----+---------+---+-+--+--+-------+----++---+----------+-/|      |           ||  |
  |||   |     |      |           |    |    |        \\-------+-+-+-/     |         |   | |  |  \\-------+----++---+----------+--+------+-----------/|  |
  |\\+---+-----+------+-----------+----+----+----------------+-+-+-------+---------/   | |  |          |    ||   |          |  |      |            |  |
  \\-+---+-----+------/           |    |    |                | | |       |             | |  |          |    ||   |          |  |      |            |  |
    |   |     |                  |    |    \\----------------+-+-+-------+-------------+-+--+----------+----++---+----------+--+------/            |  |
    |   \\-----+------------------+----+---------------------+-+-+-------/             \\-+--+----------+----++---+----------+--+-------------------+--/
    |         |                  \\----+---------------------+-/ |                       |  \\----------+----/|   |          |  |                   |   
    \\---------+-----------------------+---------------------/   |                       \\-------------+-----+---+----------/  |                   |   
              |                       |                         \\-------------------------------------+-----+---/             |                   |   
              \\-----------------------+---------------------------------------------------------------/     \\-----------------+-------------------/   
                                      \\-------------------------------------------------------------------------------------->/                       
"""

tests = ["""/->-\\        
|   |  /----\\
| /-+--+-\\  |
| | |  | v  |
\\-+-/  \\-+--/
  \\------/   """]

def scan_world(carts,world):
    L, R, U, D, V, H = "<", ">", "^", "v", "|", "-"
    dirs = {R:(1,0), L:(-1,0), U:(0,-1), D:(0,1)}
    roads = {R:H, L:H, U:V, D:V}
    for y,row in enumerate(world):
        for x,cell in ((x,c) for x,c in enumerate(row) if c in dirs):
            carts[(x,y)] = (dirs[cell],0)
            world[y][x] = roads[cell]

def run(data):
    world = [list(row) for row in data.splitlines()]
    carts = {}
    scan_world(carts,world)

    xdim = len(world[0])
    junction = '+'
    # 90° anticlock rotation, Identity, 90° clock rotation
    jturns = (((0,-1),(1,0)),((1,0),(0,1)),((0,1),(-1,0)))
    # Reflection in y = -x and reflection in y = x
    bturns = {'/':((0,-1),(-1,0)), '\\':((0,1),(1,0))}
 
    while True:
        for pos in sorted(carts.keys(),key=lambda p: p[1]*xdim+p[0]):
            dir, j = carts.pop(pos)
            x,y = (pos[i] + dir[i] for i in range(2))
            if (x,y) in carts:
                return (x,y) # Crash!
            road = world[y][x]
            if road in bturns:
                dir = dot(dir,bturns[road]) # Matrix multiply
            elif road is junction:
                dir = dot(dir,jturns[j])
                j = (j + 1) % len(jturns)
            carts[(x,y)] = (dir,j)

for test in [t for t in tests if t]:
    try: print(run(test))
    except Exception as e: print("Error:",e)
    
print(run(data))
